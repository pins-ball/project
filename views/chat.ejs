<!DOCTYPE html>
<html>
<head>
  <title>실시간 채팅 서비스</title>
  <link rel="stylesheet" href="stylesheet/style.css">
</head>
<body>
  <h1>실시간 채팅 서비스</h1>
  <h2>사용자 이름: <%= username %></h2>

  <div id="chat-container">
    <div id="chat-messages">
      <!-- 채팅 메시지들을 표시할 영역 -->
    </div>

    <div id="chat-form">
      <input type="text" id="message-input" placeholder="메시지 입력">
      <button id="send-button">전송</button>
    </div>
  </div>

  <script src="/socket.io/socket.io.js"></script>
  <script>
    // 소켓 연결
    var socket = io();

    // 사용자 이름
    var username = '<%= username %>';

    // 새로운 메시지를 서버로 전송
    function sendMessage() {
      var message = document.getElementById('message-input').value;
      socket.emit('newMessage', { message: message, username: username });
      document.getElementById('message-input').value = '';
    }

    // 메시지를 화면에 표시
    function showMessage(message) {
      var messageElement = document.createElement('div');
      messageElement.textContent = message.username + ': ' + message.message;
      document.getElementById('chat-messages').appendChild(messageElement);
    }

    // 새로운 메시지를 받으면 화면에 표시
    socket.on('newMessage', function (message) {
      showMessage(message);
    });

    // 전송 버튼 클릭 이벤트 처리
    document.getElementById('send-button').addEventListener('click', function () {
      sendMessage();
    });

    // 엔터 키 입력 이벤트 처리
    document.getElementById('message-input').addEventListener('keydown', function (event) {
      if (event.keyCode === 13) {
        sendMessage();
      }
    });
  </script>
</body>
</html>
