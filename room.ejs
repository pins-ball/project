<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>방 목록</title>
  <style>
    /* 필요한 스타일을 추가해주세요. */
  </style>
</head>
<body>
  <h1>방 목록</h1>

  <form id="create-room-form">
    <input type="text" id="room-name-input" placeholder="방 이름" required>
    <input type="hidden" id="user-name-input" value="<%= name %>">
    <button type="button" onclick="createRoom()">방 생성</button>
  </form>

  <ul id="room-list">
    <% rooms.forEach(function(room) { %>
      <li>
        <%= room.roomName %>
        <button type="button" onclick="joinRoom('<%= room.roomName %>')">방 입장</button>
      </li>
    <% }) %>
  </ul>

  <script>
    function createRoom() {
      const roomName = document.getElementById('room-name-input').value;
      const name = document.getElementById('user-name-input').value;

      // 서버로 방 생성 요청을 보냅니다.
      fetch('/create-room', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({ roomName, name }),
      })
      .then((response) => {
        if (response.ok) {
          // 방이 생성되면 채팅 화면으로 이동합니다.
          window.location.href = '/chat?room=' + roomName;
        } else {
          console.error('방 생성에 실패했습니다.');
        }
      })
      .catch((error) => {
        console.error('방 생성 요청 중 오류가 발생했습니다:', error);
      });
    }

    function joinRoom(roomName) {
      const name = document.getElementById('user-name-input').value;

      // 채팅 화면으로 이동합니다.
      window.location.href = '/chat?room=' + roomName;
    }
  </script>
</body>
</html>
